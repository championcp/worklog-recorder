# Sprint 3 用户故事
## Nobody Logger - 时间跟踪系统

**版本**: 1.0  
**日期**: 2025年8月5日  
**产品负责人**: Multi-Agent Development Team

---

## 史诗 (Epic): 时间跟踪系统
作为Nobody Logger用户，我希望能够跟踪和记录我在各个项目和任务上花费的时间，以便更好地管理我的工作效率和项目进度。

---

## 用户故事

### 🎯 史诗1: 实时计时器功能

#### US-3.1: 启动任务计时器
**作为** 项目管理用户  
**我希望** 能够为特定任务启动一个计时器  
**以便** 实时跟踪我在该任务上花费的时间

**接受标准**:
- [ ] 我可以从项目列表中选择一个项目
- [ ] 我可以从选定项目的任务列表中选择一个任务  
- [ ] 我可以点击"开始计时"按钮启动计时器
- [ ] 我可以为计时器添加可选的工作描述
- [ ] 计时器启动后，界面显示实时的计时时间(HH:MM:SS格式)
- [ ] 系统阻止我同时启动多个计时器
- [ ] 我只能为自己有权限的项目任务启动计时器

**估点**: 8  
**优先级**: High  
**依赖**: 现有的项目和任务管理系统

#### US-3.2: 停止计时器并保存记录
**作为** 项目管理用户  
**我希望** 能够停止当前运行的计时器并自动保存时间记录  
**以便** 准确记录我在任务上花费的实际时间

**接受标准**:
- [ ] 我可以看到当前活跃计时器的状态和已用时间
- [ ] 我可以点击"停止计时"按钮停止计时器
- [ ] 计时器停止后，系统自动计算总持续时间
- [ ] 时间记录自动保存到数据库
- [ ] 相关任务的实际工时自动更新
- [ ] 我可以看到保存成功的确认消息
- [ ] 计时器界面重置为初始状态

**估点**: 5  
**优先级**: High  
**依赖**: US-3.1

#### US-3.3: 查看活跃计时器状态
**作为** 项目管理用户  
**我希望** 能够随时查看当前活跃计时器的状态  
**以便** 了解我正在进行的工作和已用时间

**接受标准**:
- [ ] 如果有活跃计时器，我可以在界面上看到计时器显示
- [ ] 计时器显示包括：任务名称、项目名称、开始时间、已用时间
- [ ] 时间显示实时更新（每秒刷新）
- [ ] 我可以看到当前计时器的工作描述
- [ ] 如果没有活跃计时器，界面显示相应提示

**估点**: 3  
**优先级**: Medium  
**依赖**: US-3.1

---

### 📝 史诗2: 手动时间录入功能

#### US-3.4: 手动添加时间记录
**作为** 项目管理用户  
**我希望** 能够手动添加历史时间记录  
**以便** 补充记录我之前忘记计时的工作时间

**接受标准**:
- [ ] 我可以选择项目和任务
- [ ] 我可以选择工作日期（默认为今天）
- [ ] 我可以输入开始时间
- [ ] 我可以输入结束时间（可选）
- [ ] 如果只输入开始时间，我可以输入持续时长
- [ ] 我可以添加工作描述（最多500字符）
- [ ] 系统验证结束时间晚于开始时间
- [ ] 系统自动计算持续时间
- [ ] 我可以保存时间记录
- [ ] 相关任务的实际工时自动更新

**估点**: 8  
**优先级**: High  
**依赖**: 现有的项目和任务管理系统

#### US-3.5: 编辑历史时间记录
**作为** 项目管理用户  
**我希望** 能够编辑我之前创建的时间记录  
**以便** 修正错误或补充信息

**接受标准**:
- [ ] 我可以查看我的历史时间记录列表
- [ ] 我可以点击编辑按钮修改时间记录
- [ ] 我可以修改工作描述
- [ ] 我可以修改开始时间和结束时间
- [ ] 系统重新验证修改后的时间
- [ ] 保存后，相关任务的实际工时重新计算
- [ ] 我只能编辑自己的时间记录

**估点**: 5  
**优先级**: Medium  
**依赖**: US-3.4

#### US-3.6: 删除时间记录
**作为** 项目管理用户  
**我希望** 能够删除错误的时间记录  
**以便** 保持时间数据的准确性

**接受标准**:
- [ ] 我可以选择要删除的时间记录
- [ ] 系统显示删除确认对话框
- [ ] 确认删除后，记录进行软删除（标记为已删除）
- [ ] 相关任务的实际工时重新计算
- [ ] 我只能删除自己的时间记录
- [ ] 删除操作有审计记录

**估点**: 3  
**优先级**: Low  
**依赖**: US-3.4

---

### 📊 史诗3: 时间统计和查看功能

#### US-3.7: 查看时间统计
**作为** 项目管理用户  
**我希望** 能够查看我的时间统计信息  
**以便** 了解我的工作时间分配和效率

**接受标准**:
- [ ] 我可以查看总工作时间
- [ ] 我可以查看平均每次工作时长
- [ ] 我可以查看工作天数统计
- [ ] 我可以按任务查看时间分布
- [ ] 我可以按项目查看时间分布
- [ ] 我可以选择时间范围进行筛选
- [ ] 统计数据实时更新

**估点**: 5  
**优先级**: Medium  
**依赖**: US-3.1, US-3.4

#### US-3.8: 查看历史时间记录
**作为** 项目管理用户  
**我希望** 能够查看我的历史时间记录列表  
**以便** 回顾我的工作历史和时间分配

**接受标准**:
- [ ] 我可以看到时间记录的分页列表
- [ ] 每条记录显示：日期、任务、项目、持续时间、描述
- [ ] 我可以按日期范围筛选记录
- [ ] 我可以按项目筛选记录
- [ ] 我可以按任务筛选记录
- [ ] 记录按时间倒序排列
- [ ] 我可以快速识别计时器记录和手动记录

**估点**: 5  
**优先级**: Medium  
**依赖**: US-3.1, US-3.4

---

### 🔧 史诗4: 系统集成和管理功能

#### US-3.9: 项目任务集成
**作为** 系统管理员  
**我希望** 时间跟踪系统与现有项目管理系统无缝集成  
**以便** 用户可以方便地为任务记录时间

**接受标准**:
- [ ] 时间跟踪界面显示用户有权限的所有项目
- [ ] 选择项目后，动态加载该项目下的任务列表
- [ ] 任务显示包括WBS编码和任务名称
- [ ] 时间记录成功后，任务的实际工时字段自动更新
- [ ] 支持项目和任务的权限验证
- [ ] 处理项目或任务被删除的情况

**估点**: 6  
**优先级**: High  
**依赖**: 现有项目管理系统

#### US-3.10: 用户权限管理
**作为** 系统管理员  
**我希望** 确保用户只能访问和记录自己项目的时间  
**以便** 维护数据安全和隐私

**接受标准**:
- [ ] 用户只能看到自己创建的项目
- [ ] 用户只能为自己项目下的任务记录时间
- [ ] 用户只能查看和编辑自己的时间记录
- [ ] 所有API端点进行权限验证
- [ ] 未授权访问返回适当的错误信息
- [ ] 审计记录所有权限相关操作

**估点**: 4  
**优先级**: High  
**依赖**: 现有认证系统

---

## 非功能性需求用户故事

#### US-3.11: 系统性能
**作为** 项目管理用户  
**我希望** 时间跟踪系统响应快速  
**以便** 不影响我的工作流程

**接受标准**:
- [ ] API响应时间 < 200ms
- [ ] 计时器界面更新流畅
- [ ] 支持100个并发用户
- [ ] 页面加载时间 < 3秒

**估点**: 3  
**优先级**: Medium

#### US-3.12: 移动端支持
**作为** 移动设备用户  
**我希望** 能在手机上使用时间跟踪功能  
**以便** 随时随地记录工作时间

**接受标准**:
- [ ] 界面在移动设备上正确显示
- [ ] 触摸操作响应正常
- [ ] 计时器在后台运行时保持准确
- [ ] 关键功能在小屏幕上易于操作

**估点**: 5  
**优先级**: Medium

---

## 用户故事总结

### 按优先级分类:
- **High Priority**: US-3.1, US-3.2, US-3.4, US-3.9, US-3.10 (31估点)
- **Medium Priority**: US-3.3, US-3.5, US-3.7, US-3.8, US-3.11, US-3.12 (26估点)  
- **Low Priority**: US-3.6 (3估点)

### 总估点: 60 估点

### Sprint容量评估:
基于2周Sprint，团队速度预估35-40估点，当前用户故事略超容量，建议将部分Medium和Low优先级故事移至下个Sprint。

---

## 验收测试场景

### 端到端测试场景:

1. **完整工作流程测试**:
   - 用户登录 → 选择项目 → 选择任务 → 启动计时器 → 工作一段时间 → 停止计时器 → 验证时间记录保存

2. **手动录入测试**:
   - 用户登录 → 选择项目和任务 → 输入历史时间 → 保存 → 验证任务工时更新

3. **错误处理测试**:
   - 测试各种输入验证和错误情况处理

4. **权限测试**:
   - 验证用户只能访问自己的数据

---

**文档状态**: 已完成  
**最后更新**: 2025年8月5日  
**相关文档**: [Sprint 3 PRD](./sprint3-prd.md)